<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<title>Find My Plugin - Home</title>
	<link rel="stylesheet" href="assets/css/style.css">
</head>

<body>
	<header class="site-header container">
		<div class="nav-wrapper ">
			<a href="index.html" class="brand">Find My Plugin</a>
			<nav>
				<ul class="nav-list" id="mainNav">
					<li class="nav-item">
						<a href="#" class="nav-link">Products <svg width="12" height="12" viewBox="0 0 16 16">
								<path d="M4 6l4 4 4-4" stroke="currentColor" fill="none"></path>
							</svg></a>
						<div class="megamenu">
							<div class="megamenu-grid">
								<div class="menu-section">
									<h4>Chrome Extentions</h4>
									<ul class="menu-list">
										<li class="menu-item" data-title="Amazing YouTube Helper" >
											<span class="icon">üì±</span>
											<div>
												<div class="menu-item-title">Amazing YouTube Helper</div>
												<div class="menu-item-desc">Extension to boost Youtube</div>
											</div>
										</li>
										<!-- Add more categories -->
									</ul>
								</div>
								<div class="menu-section">
									<h4>WordPress Plugins</h4>
									<ul class="menu-list">
										<li class="menu-item" data-title="WordPress SEO Optimizer">
											<span class="icon">üåê</span>
											<div>
												<div class="menu-item-title">WordPress SEO Optimizer</div>
												<div class="menu-item-desc">Improve your site ranking</div>
											</div>
										</li>
										<!-- Add more categories -->
									</ul>
									<!-- Add more sections -->
								</div>
							</div>
					</li>
					<li class="nav-item">
						<a href="#" class="nav-link">Resources <svg width="12" height="12" viewBox="0 0 16 16">
								<path d="M4 6l4 4 4-4" stroke="currentColor" fill="none"></path>
							</svg></a>
						<!-- Add Resources megamenu -->
					</li>
					<li class="nav-item"><a href="listing.html" class="nav-link">Browse</a></li>
					<li class="nav-item"><a href="contact.html" class="nav-link">Contact</a></li>
				</ul>
			</nav>
			<button class="mobile-menu-btn" id="mobileMenuBtn">
				<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
					<path d="M3 12h18M3 6h18M3 18h18" />
				</svg>
			</button>
		</div>
	</header>

	<main class="container">
		<!-- Hero section with image background -->
		<section class="hero hero-banner"
			style="background: url('assets/images/banner.jpg') center/cover no-repeat; border-radius: 18px; min-height: 340px; display: flex; flex-direction: column; align-items: center; justify-content: center; margin-bottom: 32px; position: relative;">
			<div>
				<!-- <h1 style="font-size:2.4rem; font-weight:700; margin-bottom:18px; color:#111;">Discover plugins, extensions and integrations</h1>
				<p style="font-size:1.15rem; color:#444; margin-bottom:28px;">Pellentesque egestas, neque sit amet convallis pulvinar, justo nulla eleifend augue, ac auctor orci leo non est. Aliquam eu nunc. Quisque ut nisi. 
				</p> -->
				<!-- <div style="display:flex; gap:18px; justify-content:center;">
					<a href="#" class="btn" style="background:#111; color:#fff; min-width:160px;">&#9650; Start Deploying</a>
					<a href="#" class="btn ghost" style="background:#fff; color:#222; min-width:160px;">Get a Demo</a>
				</div> -->
			</div>
		</section>

		<section class="hero">
			<h1>Discover plugins, extensions and integrations</h1>
			<form id="searchForm" class="search-form">
				<input id="searchInput" placeholder="Search plugins, categories, tags..." />
				<button type="submit">Search</button>
			</form>
			<div class="hero-actions">
				<!-- <button id="openRequestBtn" class="btn">Request for plugin</button> -->
				<a href="request-for-plugin.html" class="btn">Request for plugin</a>
				<a href="listing.html" class="btn ghost">Browse Templates</a>
				<!-- Mobile filter button -->
				<button id="openFilterSidebar" class="btn ghost mobile-only" type="button"
					style="margin-left:8px;">Filters</button>
			</div>
		</section>

		<section class="two-col">
			<aside class="sidebar" id="mainSidebar">
				<h3>Categories</h3>
				<ul id="categoryList" class="category-list"></ul>
				<h3>Top Tags</h3>
				<div id="tagList" class="tag-cloud"></div>
			</aside>
			<section class="plugin-grid" id="featuredGrid">
				<h2>Featured Plugins</h2>
				<div id="pluginsContainer" class="grid"></div>
			</section>
		</section>
	</main>

	<!-- Mobile filter sidebar popup -->
	<div id="filterSidebarModal" class="modal filter-sidebar-modal" aria-hidden="true">
		<div class="modal-panel sidebar-panel">
			<button class="close" id="closeFilterSidebar">&times;</button>
			<h3>Filters</h3>
			<div>
				<h4>Categories</h4>
				<ul id="categoryListMobile" class="category-list"></ul>
				<h4>Top Tags</h4>
				<div id="tagListMobile" class="tag-cloud"></div>
			</div>
		</div>
	</div>

	<footer class="site-footer">
		<div class="container">
			<div class="footer-grid">
				<div class="footer-section">
					<h4>Products</h4>
					<ul class="footer-links">
						<li><a href="#">Marketplace</a></li>
						<li><a href="listing.html">Templates</a></li>
						<li><a href="#">Guides</a></li>
					</ul>
				</div>
				<div class="footer-section">
					<h4>Resources</h4>
					<ul class="footer-links">
						<li><a href="#">Documentation</a></li>
						<li><a href="#">Blog</a></li>
						<li><a href="#">Community</a></li>
					</ul>
				</div>
				<div class="footer-section">
					<h4>Company</h4>
					<ul class="footer-links">
						<li><a href="#">About</a></li>
						<li><a href="#">Careers</a></li>
						<li><a href="contact.html">Contact</a></li>
					</ul>
				</div>
				<div class="footer-section">
					<h4>Social</h4>
					<ul class="footer-links">
						<li><a href="#">Twitter</a></li>
						<li><a href="#">GitHub</a></li>
						<li><a href="#">LinkedIn</a></li>
					</ul>
				</div>
			</div>
			<div class="footer-bottom">
				<div>¬© Find My Plugin ‚Ä¢ <a href="privacy.html">Privacy policy</a></div>
				<div class="social-links">
					<a href="#" target="_blank">Twitter</a>
					<a href="#" target="_blank">GitHub</a>
					<a href="#" target="_blank">LinkedIn</a>
				</div>
			</div>
		</div>
	</footer>

	<!-- Request for plugin modal -->
	<div id="requestModal" class="modal" aria-hidden="true">
		<div class="modal-panel">
			<button class="close" id="closeRequest">&times;</button>
			<h3>Request a Plugin</h3>
			<form id="requestForm">
				<label>Requirement</label>
				<textarea id="reqText" required></textarea>
				<label>Attach doc (optional)</label>
				<input type="file" id="reqFile" accept=".pdf,.doc,.docx,.txt" />
				<label>Name</label>
				<input id="reqName" required />
				<label>Email</label>
				<input id="reqEmail" type="email" required />
				<label>Contact number</label>
				<input id="reqPhone" />
				<button type="submit" class="btn">Submit Request</button>
			</form>
		</div>
	</div>

	<script src="assets/js/app.js"></script>
	<script>
		document.getElementById('mobileMenuBtn').addEventListener('click', function () {
			document.getElementById('mainNav').classList.toggle('active');
		});

		// Mobile megamenu toggle for nav-items with megamenu
		document.querySelectorAll('.nav-item').forEach(function (item) {
			var link = item.querySelector('.nav-link');
			var megamenu = item.querySelector('.megamenu');
			if (link && megamenu) {
				link.addEventListener('click', function (e) {
					if (window.innerWidth <= 900) {
						e.preventDefault();
						// Close other open megamenus
						document.querySelectorAll('.nav-item.open').forEach(function (openItem) {
							if (openItem !== item) openItem.classList.remove('open');
						});
						item.classList.toggle('open');
					}
				});
			}
		});

	</script>

	<script>
// === Products mega-menu: open detail page dynamically (no hardcoded IDs) ===

// Build a title -> id map once (lazy)
let __titleToId = null;
async function ensureTitleMap() {
  if (__titleToId) return __titleToId;
  const items = await window.Store.list(); // [{_id,title,...}]
  __titleToId = new Map(
    (items || []).map(p => [(p.title || '').trim().toLowerCase(), (p._id || p.id)])
  );
  return __titleToId;
}

// Delegate clicks to rows in the mega-menu
document.addEventListener('click', async (e) => {
  const row = e.target.closest('.megamenu .menu-item[data-title]');
  if (!row) return;

  e.preventDefault();

  const title = (row.dataset.title || row.querySelector('.menu-item-title')?.textContent || '')
                .trim().toLowerCase();
  if (!title) return;

  try {
    const map = await ensureTitleMap();
    const id = map.get(title);

    if (id) {
      location.href = `detail.html?id=${id}`;
    } else {
      // Fallback: live search, then update the cache
      const results = await window.Store.list({ q: title });
      const match = (results || []).find(p => (p.title || '').trim().toLowerCase() === title);
      if (match) {
        const mid = match._id || match.id;
        __titleToId.set(title, mid);
        location.href = `detail.html?id=${mid}`;
      } else {
        window.showToast?.('Plugin not found', 'warning');
      }
    }
  } catch (err) {
    window.showToast?.('Open failed: ' + err.message, 'error');
  }
});
</script>

</body>

</html>