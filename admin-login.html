<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin Login • Find My Plugin</title>

  <!-- Site fonts + global styles (same as other pages) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="assets/css/style.css">

  <!-- Scoped styles just for this page -->
  <style>
    .auth-wrap { min-height: calc(100dvh - 140px); display:grid; place-items:center; }
    .auth-card {
      width: 100%;
      max-width: 460px;
      background: #fff;
      border: 1px solid #e7e7e9;
      border-radius: 12px;
      padding: 28px;
      box-shadow: 0 8px 24px rgba(16,24,40,.06);
    }
    .auth-title { margin: 0 0 6px; font-size: 22px; font-weight: 700; letter-spacing: -.01em; }
    .auth-sub { margin: 0 0 18px; color:#6b7280; font-size: 14px; }
    .form-row { margin: 12px 0 16px; }
    .form-row label { display:block; font-size: 13px; color:#374151; margin-bottom: 6px; }
    .input {
      width: 100%; padding: 12px 12px; border: 1px solid #e5e7eb; border-radius: 8px; background:#fff;
      font: inherit; outline: none; transition: border-color .15s ease, box-shadow .15s ease;
    }
    .input:focus { border-color:#6366f1; box-shadow: 0 0 0 4px rgba(99,102,241,.1); }
    .actions { display:flex; gap: 12px; align-items:center; margin-top: 6px; }
    .err { color:#b91c1c; font-size: 13px; min-height: 18px; }
    .muted { color:#6b7280; font-size: 12px; }
    .center { text-align:center; }
  </style>
</head>

<body>
  <!-- Header reused from site -->
  <header class="site-header container">
    <div class="nav-wrapper">
      <a href="index.html" class="brand">Find My Plugin</a>
      <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Toggle menu">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 12h18M3 6h18M3 18h18" />
        </svg>
      </button>
      <nav>
        <ul class="nav-list" id="mainNav">
          <li class="nav-item"><a href="listing.html" class="nav-link">Browse</a></li>
          <li class="nav-item"><a href="contact.html" class="nav-link">Contact</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- Auth content -->
  <main class="container auth-wrap">
    <div class="auth-card">
      <h1 class="auth-title">Admin login</h1>
      <p class="auth-sub">Only authorized admins can access the dashboard.</p>

      <form id="loginForm" novalidate>
        <div class="form-row">
          <label for="email">Email</label>
          <input id="email" class="input" type="email" placeholder="you@company.com" required />
        </div>
        <div class="form-row">
          <label for="password">Password</label>
          <input id="password" class="input" type="password" placeholder="••••••••" required />
        </div>

        <div class="actions">
          <button type="submit" class="btn" style="width:100%">Login</button>
        </div>

        <p id="err" class="err"></p>
        <p class="center muted"><a href="index.html">← Back to site</a></p>
      </form>
    </div>
  </main>

  <!-- Footer reused -->
  <footer class="site-footer">
    <div class="container">
      <div class="footer-bottom" style="display:flex;justify-content:space-between;gap:12px;flex-wrap:wrap;">
        <div>© Find My Plugin</div>
        <div class="social-links">
          <a href="#" target="_blank">Twitter</a>
          <a href="#" target="_blank">GitHub</a>
          <a href="#" target="_blank">LinkedIn</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script>
    // Same-host API in dev to avoid SameSite issues
    const isLocal = ["localhost","127.0.0.1","::1"].includes(location.hostname);
    const API = isLocal
      ? `http://${location.hostname}:5000/api`
      : 'https://<YOUR-RENDER-BACKEND>.onrender.com/api'; // set your Render URL for deploy

    document.getElementById('loginForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const errEl = document.getElementById('err');
      errEl.textContent = '';

      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value;

      if (!email || !password) {
        errEl.textContent = 'Please enter both email and password.';
        return;
      }

      try {
        const res = await fetch(`${API}/auth/login`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          credentials: 'include',
          body: JSON.stringify({ email, password })
        });

        if (!res.ok) {
          const j = await res.json().catch(()=>({}));
          throw new Error(j.message || 'Invalid credentials');
        }
        location.href = 'admin.html';
      } catch (e) {
        errEl.textContent = e.message || 'Login failed';
      }
    });

    // mobile nav toggle (same as other pages)
    document.getElementById('mobileMenuBtn').addEventListener('click', function () {
      document.getElementById('mainNav').classList.toggle('active');
    });
  </script>
</body>
</html>
